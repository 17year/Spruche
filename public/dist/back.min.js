!function(a){var b=a("#content-iframe"),c=a("#wrapper"),d=a(".menu-li"),e=a(".sub-menu"),f=a(".sub"),g=a(".sub-menu-li"),h=a(".arrow"),i=!1;location.hostname+location.port+"/admin";window.onload=function(){var c=location.hash;c=c.substr(1,c.length),""==c&&(c="index",location.hash=c),a(".menu-li:not(.menu-"+c+")").removeClass("active open"),a(".menu-li.menu-"+c).addClass("active"),a(".sub-menu-li.menu-"+c).addClass("active"),a(".sub-menu-li.menu-"+c).parent(".sub").addClass("active"),a(".sub-menu-li.menu-"+c).parent(".sub").slideDown(200),b.attr("src","/admin/"+c)},b.load(function(){a(this).height(a(this).contents().find("html").height()),c.height(a(this).contents().find("html").height())}),d.each(function(){a(this).click(function(){d.removeClass("active"),e.removeClass("open active"),f.slideUp(200),h.removeClass("open"),a(this).addClass("active"),b.attr("src","/admin/"+a(this).attr("data-src")),location.hash=a(this).attr("data-src")})}),g.each(function(){a(this).click(function(){d.removeClass("active"),e.removeClass("open active"),g.removeClass("active"),f.removeClass("open active"),a(this).parent(".sub").addClass("active"),a(".sub:not(.active)").removeClass("open"),a(".sub:not(.active)").slideUp(200),a(".sub:not(.active)").parents(".sub-menu").find(".arrow").removeClass("open"),a(this).parents(".sub-menu").addClass("active"),a(this).parent(".sub").slideDown(),a(this).addClass("active"),b.attr("src","/admin/"+a(this).attr("data-src")),location.hash=a(this).attr("data-src")})}),a("#sidebar .sub-menu > a").click(function(){var b=a(".sub-menu.open",a("#sidebar"));b.removeClass("open"),a(".arrow",b).removeClass("open"),a(".sub",b).slideUp(200);var c=a(this).next();c.is(":visible")?(a(".arrow",a(this)).removeClass("open"),a(this).parent().removeClass("open"),c.slideUp(200)):(a(".arrow",a(this)).addClass("open"),a(this).parent().addClass("open"),c.slideDown(200));var d=a(this).offset();diff=200-d.top,diff>0?a("#sidebar").scrollTo("-="+Math.abs(diff),500):a("#sidebar").scrollTo("+="+Math.abs(diff),500)}),a("#tool-bar").click(function(){i?(a("#sidebar").animate({left:"0"},500),a("#main-content").animate({"margin-left":"180px"},500),i=!1):(a("#sidebar").animate({left:"-180px"},500),a("#main-content").animate({"margin-left":"0"},500),i=!0)}),a("#logout").click(function(){a.cookie("uid",{expires:-1,path:"/"}),a.cookie("email",{expires:-1,path:"/"}),a.cookie("type",{expires:-1,path:"/"}),a.cookie("token",{expires:-1,path:"/"}),window.location.href="/"})}($),function(a){a(".article_delete").bind("click",function(){var b=a(this).data("id"),c=a(this);a.ajax({type:"POST",url:"/admin/write/delarticle",dataType:"json",traditional:!0,data:{id:b},success:function(a){a.type?c.parents(".panel").slideUp():alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})})}($),function(a){a(document).ready(function(){a.ajax({type:"POST",url:"/admin/index/appInfo",dataType:"json",traditional:!0,success:function(b){if(b.type){var c='<div class="row"><label class="col-sm-2">当前版本：</label><span class="col-sm-10">'+b.appInfo.version+'</span></div><div class="row"><label class="col-sm-2">最新版本：</label><span class="col-sm-10">'+b.appInfo.latest+"</span></div>";b.appInfo.latest>b.appInfo.version&&(c+='<div><a class="btn btn-primary" href="'+b.appInfo.url+'" target="_blank" >查看更新方案</a>'),a("#info-main").html(c);var d=a("html").height()+a("#info-main").height();a("#wrapper",parent.document).height(d),a("#content-iframe",parent.document).height(d)}},error:function(a,b,c){}})})}(jQuery),function(a){a(document).ready(function(){var b=a("html").height()+a("#info-main").height();a("#wrapper",parent.document).height(b),a("#content-iframe",parent.document).height(b)})}(jQuery),function(a){function b(){"true"==a("#write-content").attr("data-type")&&(t=!0),t&&""!=a("#tags-div").attr("data-tags")&&(u=a("#tags-div").attr("data-tags").split(",")),console.log(u)}function c(b){a.ajax({type:"POST",url:"/admin/write/sblog",dataType:"json",traditional:!0,data:{blog:JSON.stringify(b)},success:function(a){a.type?parent.location.href="/admin":alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})}function d(b){a.ajax({type:"POST",url:"/admin/write/ablog",dataType:"json",traditional:!0,data:{blog:JSON.stringify(b)},success:function(a){a.type?parent.location.reload():alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})}function e(){var b={};b.title=k.val();var c=[];return c.push(UE.getEditor("editor").getContent()),b.content=c.join("\n"),b.summary=h(UE.getEditor("editor").getContentTxt().substr(0,180)+"..."),b.tags=u,b.classify_name=a(".classify-ipt:checked").attr("data-name"),b.classify_id=a(".classify-ipt:checked").val(),b.img="",t&&(b.id=a("#write-content").attr("data-id"),b.content=b.content.replace(/\\/g,"/")),b}function f(a){for(var b,c=[],d=0;d<a.length;d++){b=!1;for(var e=0,f=c.length;e<f;e++)if(a[d]==c[e]){b=!0;break}b||c.push(a[d])}return c}function g(a,b){for(var c=0;c<b.length&&b[c]!=a;c++);b.splice(c,1)}function h(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;"),a=a.replace(/'/g,"&#039;")}var i=a("#tags-ipt"),j=a("#add-classify-ipt"),k=a("#blog-title-ipt"),l=a("#add-tags"),m=a("#add-classify"),n=a("#tags-div"),o=(a("#blog-form"),a("#classify-ul")),p=a("#save-btn"),q=a("#publish-btn"),r=a("#alter-btn"),s=a("#update-btn"),t=!1,u=[],v=/^,|,$/gi;b(),l.bind("click",function(){var a=i.val();a=a.replace(v,"");var b=[];if(a){b=a.split(","),u=u.concat(b),u=f(u),n.html("");for(var c in u)n.append('<a class="tags-a"><span class="glyphicon glyphicon-remove remove-tags"></span><span class="tags-span">'+u[c]+"</span></a>");i.val("")}}),n.on("click",".remove-tags",function(){var b=a(this).parent().children(".tags-span").text();g(b,u),a(this).parent().css("display","none")}),m.bind("click",function(){var b=j.val();b=b.replace(/^\s+|\s+$/g,"");var c=!0;a(".classify-ipt").each(function(){if(a(this).attr("data-name")==b)return alert("分类名称重复"),void(c=!1)}),c&&a.ajax({type:"POST",url:"/admin/write/addclassify",dataType:"json",traditional:!0,data:{classify:b},success:function(a){a.type?(o.append('<li class="classify-li"><input class="classify-ipt" name="classify" type="radio" value="'+a.id+'" data-name="'+b+'"/><span>'+b+"</span></li>"),j.val("")):alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})}),q.bind("click",function(){if(""==k.val())return void alert("请输入文章标题");var a=e();return""==a.content?void alert("请输入文章内容"):(a.state=0,void c(a))}),p.bind("click",function(){if(""==k.val())return void alert("请输入文章标题");var a=e();return""==a.content?void alert("请输入文章内容"):(a.state=1,void c(a))}),r.bind("click",function(){if(""==k.val())return void alert("请输入文章标题");var a=e();return""==a.content?void alert("请输入文章内容"):void d(a)}),s.bind("click",function(){if(""==k.val())return void alert("请输入文章标题");var a=e();return""==a.content?void alert("请输入文章内容"):(a.state=0,void d(a))})}($),function(a){function b(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return!!b.test(a)}var c=a("#userform"),d=a("#email"),e=a("#username"),f=a("#wsname"),g=a("#wsdescription"),h=a("#shortname"),i=a("#user_btn"),j=a("#duoshuo_btn");i.click(function(){var f=d.val(),g=e.val();if(""===g||""===f)return void alert("用户信息不能为空");if(!b(f))return void alert("邮箱格式不正确");var h={id:c.attr("data-user"),email:d.val(),username:e.val()};a.ajax({type:"POST",url:"/admin/updateuser",dataType:"json",traditional:!0,data:{user:JSON.stringify(h)},success:function(a){a.type?(alert("修改成功"),parent.location.reload()):alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})}),j.click(function(){var b={name:f.val(),description:g.val(),short_name:h.val()};console.log(b),a.ajax({type:"POST",url:"/admin/updatews",dataType:"json",traditional:!0,data:{website:JSON.stringify(b)},success:function(a){a.type?(alert("修改成功"),parent.location.reload()):alert("网络繁忙，请稍后再试...")},error:function(a,b,c){alert("网络繁忙，请稍后再试...")}})})}(jQuery);