function myAlert(a){$("#alert_content_p").text(a),$("#alert_container").fadeIn(300),$("#alert_div").slideToggle(300)}function closeAlert(){$("#alert-btn").bind("click",function(){$("#alert_container").fadeOut(300),$("#alert_div").slideToggle(300)})}function isMobile(){var a=!!navigator.userAgent.match(/Android/i),b=!!navigator.userAgent.match(/iPhone|iPad|iPod/i),c=!!navigator.userAgent.match(/IEMobile/i),d=!!navigator.userAgent.match(/BlackBerry/i);return!!(a||b||c||d)}function pajx_loadDuodshuo(){var a=$(".ds-thread");if(1==$(a).length){var b=document.createElement("div");b.setAttribute("data-thread-key",$(a).attr("data-thread-key")),b.setAttribute("data-url",$(a).attr("data-url")),DUOSHUO.EmbedThread(b),$(a).html(b)}}!function(a){function b(){i=window.innerHeight,k=document.documentElement.scrollTop;for(var a=0;a<l.length;a++)j=l[a].offsetTop-k,j-i<-50&&(l[a].style.left="0")}function c(){l=a(".article-li"),i=window.innerHeight;for(var b=0;b<l.length;b++)k=a(document).scrollTop(),j=l[b].offsetTop-k,j-i<-50&&(l[b].style.left="0")}function d(){a("#mobile-nav").stop((!0).false).animate({left:"0"},200)}function e(){a("#mobile-nav").stop((!0).false).animate({left:"-60%"},200)}function f(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function g(a,b){var c=new Image;c.src=a,c.complete?b(c.width,c.height):c.onload=function(){b(c.width,c.height)}}function h(b){g(a(".img-view img").attr("src"),function(c,d){var e=a(window).width(),f=a(window).height();if(console.log(c/d>e/f),c/d>e/f){var g=-(d/(c/e))/2*.8;a(".img-view img").css({width:"100%",height:"auto",top:"50%","margin-top":g+"px"})}else c/d===e/f?a(".img-view img").css({width:"100%",height:"100%",top:"0","margin-top":"0"}):a(".img-view img").css({width:"auto",height:"100%",top:"0","margin-top":"0"});b&&a(".img-view").slideDown("slow")})}var i,j,k,l=a(".article-li"),m=(a(".nav_ul_li"),location.protocol+"//"+location.hostname+"/article/av",!0),n=1,o=!0,p=!0;b(),a("#container").on("click","#load-more-btn-div-cnt",function(){a("#load-more-btn-div-cnt").css("display","none"),a("#loading-div").css("display","block"),a.ajax({type:"POST",url:"/loadmoreav",dataType:"json",traditional:!0,data:{page:n},success:function(b){if(b.type){var d=b.blogs;n++;var e="";for(var f in d){if(e+='<li class="article-li"><article><div class="article-info-div"><div class="article-user-img-div float-left"><img src="'+d[f].head_img+'"></div><div class="vertical-line-div float-left"><div class="vertical-line"></div></div><div class="article-info float-left"><h3 class="article-title-h"><span class="shine-font-span"></span><a href="/article/av'+d[f].id+'" data-pjax="true">'+d[f].title+'</a></h3> <div class="article-other-info"><span><a class="article-author">'+d[f].username+'</a></span><span><a class="article-comments-num ds-thread-count" data-thread-key="'+d[f].id+'" data-count-type="comments" data-pjax="true">0 Comments</a></span><span><a class="article-view-num">'+d[f].view_num+' Views</a></span><span><a class="article-date">'+new Date(d[f].publish_date).getFullYear()+"-"+(new Date(d[f].publish_date).getMonth()+1)+"-"+new Date(d[f].publish_date).getDate()+'</a></span></div></div><div class="clearfix"></div></div>',""!=d[f].img&&(e+='<div class="article-img-div"><img src="'+d[f].img+'"></div>'),e+='<div class="article-summary-div"><a href="/article/av'+d[f].id+'" data-pjax="true"><p class="article-summary-p">'+d[f].summary+"</p></a></div>",""!=d[f].tags){e+='<div class="article-tags-div">';var g=d[f].tags.split(",");for(var h in g)e+="<a>"+g[h]+"</a>";e+="</div>"}e+='<div class="horizontal-line-div"><div class="vertical-line"></div></div></article></li>'}a("#article-ul").append(e),10==d.length&&a("#load-more-btn-div-cnt").css("display","inline-block"),c(),DUOSHUO.ThreadCount(a(".ds-thread-count")),setTimeout(function(){a("#loading-div").css("display","none")},500)}else setTimeout(function(){myAlert("网络繁忙，请稍后再试..."),a("#loading-div").css("display","none"),a("#load-more-btn-div-cnt").css("display","inline-block")},500)},error:function(b,c,d){setTimeout(function(){myAlert("网络繁忙，请稍后再试..."),a("#loading-div").css("display","none"),a("#load-more-btn-div-cnt").css("display","inline-block")},1e3)}})}),closeAlert(),a(window).on("scroll",function(){c(),o&&(a("#head_logo_div").animate({left:"20%"},800,function(){a("#head_nav_div").fadeIn(500)}),a("#head_logo").css({top:"5px",width:"70px",height:"70px","border-width":"2px",transform:"rotate(360deg)"}),a(".motto").fadeOut(800),o=!1),a(document).scrollTop()>=100?a("#backtop").fadeIn(500):a("#backtop").fadeOut(500)}),a("#get-menu-icon").bind("touchstart",function(a){f(a),p&&(d(),p=!1)}),a(document).bind("touchstart",function(){e(),p=!0}),a("#mobile-nav").bind("click",function(a){f(a)}),a(document).on("click",".article-content-div img",function(){a(".img-view img").attr("src",a(this).attr("src")),a(".img-view h5").text(a(this).attr("alt")),h(!0),m=!1}),a(".img-view").bind("click",function(){a(".img-view").slideUp("slow",function(){a(".img-view img").attr("src","")}),m=!0}),window.onresize=function(){h(!1)},a(window).bind("wheel",function(a){if(!m)return a.preventDefault(),!1}),a(document).on("click","#backtop",function(){event.preventDefault(),a("body,html").animate({scrollTop:0},600)})}(jQuery),function(a){function b(){CAPTCHAOBJ.refresh(),f.val(""),g.val("")}function c(a){var b=/^(\w){6,20}$/;return!!b.exec(a)}function d(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return!!b.test(a)}function e(b){var c=!1;h.is(":checked")&&(c=!0),c?(a.cookie("uid",b.id,{expires:7,path:"/"}),a.cookie("email",b.email,{expires:7,path:"/"}),a.cookie("type",b.type,{expires:7,path:"/"}),a.cookie("token",b.token,{expires:7,path:"/"})):(a.cookie("uid",b.id,{path:"/"}),a.cookie("email",b.email,{path:"/"}),a.cookie("type",b.type,{path:"/"}),a.cookie("token",b.token,{path:"/"})),window.location.href="/admin#index"}var f=a("#email"),g=a("#password"),h=a("#remember"),i=a("#sure_btn");i.bind("click",function(){return""==f.val()||""==g.val()?(myAlert("请输入用户名和密码"),!1):d(f.val())?c(g.val())?CAPTCHAOBJ.getValidate()?(a.ajax({type:"POST",url:"/ulogin",dataType:"json",traditional:!0,data:{email:f.val(),password:g.val()},success:function(a){switch(a.type){case 0:e(a.user);break;case 1:myAlert("用户名或密码错误"),b();break;case 2:myAlert("你是机器人吗？"),b()}},error:function(a,b,c){myAlert("网络繁忙，请稍后再试...")}}),!1):(myAlert("请滑动验证码！"),!1):(myAlert("密码只能输入6-20个字母、数字、下划线"),!1):(myAlert("邮箱格式不正确"),!1)}),closeAlert()}(jQuery),$(document).pjax('a[data-pjax="true"]',"#container",{fragment:"#container",timeout:8e3}),$(document).on("pjax:beforeSend",function(){$("#progress-bar").animate({width:"20%"})}),$(document).on("pjax:send",function(){$("#progress-bar").animate({width:"40%"})}),$(document).on("pjax:complete",function(){$("#progress-bar").animate({width:"80%"})}),$(document).on("pjax:end",function(){$("#progress-bar").animate({width:"100%"},function(){$("#progress-bar").css({width:"0"})}),SyntaxHighlighter.highlight(),$("table.syntaxhighlighter").each(function(){if(!$(this).hasClass("nogutter")){var a=$($(this).find(".gutter")[0]),b=$($(this).find(".code .line"));a.find(".line").each(function(a){$(this).height($(b[a]).height()),$(b[a]).height($(b[a]).height())})}}),pajx_loadDuodshuo(),DUOSHUO.ThreadCount($(".ds-thread-count"))}),function(a){function b(a){var b=/^(\w|@|#|\$|%|\^|&|\*){6,20}$/;return!!b.exec(a)}function c(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return!!b.test(a)}var d=a("#website"),e=a("#username"),f=a("#email"),g=a("#password"),h=a("#rpassword"),i=a("#sure_btn"),j=location.protocol+"//"+location.hostname;i.bind("click",function(){return""==d.val()||""==e.val()||""==f.val()||""==g.val()||""==h.val()?(myAlert("信息不能为空"),!1):b(g.val())?c(f.val())?g.val()==h.val()?(a.ajax({type:"POST",url:"/start",dataType:"json",traditional:!0,data:{website:d.val(),username:e.val(),email:f.val(),password:g.val(),domain:j},success:function(a){a&&(window.location.href="/login")},error:function(a,b,c){myAlert("网络繁忙，请稍后再试...")}}),!1):(myAlert("两次密码不一样"),!1):(myAlert("请输入正确的邮箱"),!1):(myAlert("密码只能输入6-20个字母、数字、特殊字符"),!1)}),closeAlert()}(jQuery),function(a){function b(b){for(var d="",e=b.length-1;e>=0;e--)d+="<a>"+b[e].tags_name+"</a>";a("#tags").html(d),c()}function c(){try{var b,c=document.getElementById("tags").childNodes;for(b in c)"A"==c[b].nodeName&&c[b].addEventListener("click",function(a){a.preventDefault()});a("#tag_canvas").attr("width",a(window).width()),a("#tag_canvas").attr("height",a(window).height()),TagCanvas.Start("tag_canvas","tags",{textColour:"#a7a7a7",outlineColour:"#ffffff",reverse:!0,textHeight:15,bgOutlineThickness:0,depth:.5,dragControl:!1,decel:.75,dragThreshold:10,fadeIn:3e3,maxSpeed:.05,initial:[-.1,.1],maxBrightness:.8,maxSpeed:.03,noSelect:!0,wheelZoom:!1})}catch(a){}}a(document).ready(function(){isMobile()?a("#tags-canvas-content").css("display","none"):a.ajax({type:"POST",url:"/tags",dataType:"json",traditional:!0,data:{},success:function(a){a.type&&b(a.tags)},error:function(a,b,c){}})}),a(window).resize(function(){a("#tag_canvas").attr("width",a(window).width()),a("#tag_canvas").attr("height",a(window).height())})}(jQuery);var alert_flag=!1,timer;